@{
    ViewBag.Title = "Knockout";
}

<script src="@Url.Content("~/Scripts/knockout.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/knockout-app/app.js")" type="text/javascript"></script>

<h2>Dashboard</h2>
<div id="dashboard">
    <div class="row" style="margin-bottom: 10px">
        <select data-bind="options: rabbits, value: selectedRabbit, optionsCaption: 'select a rabbit...', optionsText: 'Name'" class="span4" id="rabbitsDropDown">
        </select>
        <i class="icon-plus" style="cursor: pointer">&nbsp;</i>
    </div>
    <div class="row">
      <input id="addTask" type="button" class="btn hide" value="add task" />
      <div>&nbsp;</div>
    </div>
    <div class="row">
        <table id="tasks" class="table table-stripped">
          <tbody data-bind='template: { name: "taskTemplate", foreach: tasks, afterRender: taskRenderComplete }'>
          </tbody>
        </table>
    </div>
    <div class="modal hide" id="newRabbitModal">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3>Create Rabbit</h3>
      </div>
      <div class="modal-body">
        <p>
            <label>Name</label>
            <input type="text" id="newRabbitName" />
        </p>
      </div>
      <div class="modal-footer">
        <a href="javascript:;" class="btn" data-dismiss="modal">Close</a>
        <a href="javascript:;" id="createRabbit" class="btn btn-primary">Save</a>
      </div>
    </div>
    <div class="modal hide" id="loadingModal">
      <div class="modal-body">
        <div class="row span16">
          loading...
        </div>
      </div>
    </div>
</div>

<script type="text/html" id="taskTemplate">
<tr>
  <td class='span4'>
    <input class='description' type='input' data-bind="value: Description, valueUpdate: 'keyup', event: { keyup: determineSave }" />
  </td>
  <td class='span4'>
    <input class='date' type='input' data-bind="value: DueDate, valueUpdate: 'keyup', event: { keyup: determineSave }" />
    <span data-bind="text: ParsedDate" class='label label-inverse'></span>
  </td>
  <td class='span3'>
      <span data-bind="visible: IsInvalid, text: ErrorsString" class='label label-important'></span>
      <input data-bind="visible: CanSave, click: save" type='button' class='btn btn-primary' value='save' style='padding-top: 1px; padding-bottom: 1px' />
  </td>
  <td class='span1'>
    <i class="icon-remove" style="cursor: pointer">&nbsp;</i>
  </td>
</tr>
</script>
